<!DOCTYPE html>
<html lang="de">

  <head>
    <meta charset="utf-8">

    <title>Testing CSS support with JavaScript</title>

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/simple.css" id="theme">

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">
  </head>

  <body>

    <div class="reveal">
      <div class="slides">

<!-- ******************************************************************** -->

<section>
<h1>Testing CSS support with JavaScript</h1>

<p><img src="images/nausicaa-forscher.jpg" width="70%" alt="Nausicaä" title="Nausicaä"></p>

<p><a href="http://2014.jsunconf.eu/">jsunconf 2014</a>, 2014-04-26</p>

</script>
</section>

<section data-markdown>
<script type="text/template">
# molily

<a href="http://chaplinjs.org"><img src="images/chaplin.gif" alt="Chaplin.js"></a>

- <a href="http://molily.de">molily.de</a> – <a href="https://twitter.com/molily">@molily</a>
- Software developer at <a href="http://9elements.com">9elements</a>
- Initiator of <a href="http://chaplinjs.org">Chaplin.js</a>
</script>
</section>

<section data-markdown>
<script type="text/template">
# Testing CSS support

- Does the browser support a property?
- Does the browser support a specific property value?
- What’s the vendor prefix, if any?
</script>
</section>

<section data-markdown>
<script type="text/template">
# Why bother?

- General rule: Avoid inline styles, toggle classes
- Separation of concerns:<br>JavaScript: Behavior, CSS: Presentation
- Sometimes inline styles are necessary
 - Trigger CSS transitions
 - Manual step animations (like jQuery#animate)
- Load a polyfill or a less-fancy fallback
</script>
</section>

<section data-markdown>
<script type="text/template">
# CSS Object Model (CSSOM)

- The bridge between CSS and JavaScript
- Accessing stylesheets and element style via JavaScript
- <a href="http://dev.w3.org/csswg/cssom/">CSSOM – Editor’s Draft, W3C CSS Working Group</a>
- Origin: <a href="http://www.w3.org/TR/DOM-Level-2-Style/">DOM 2 CSS</a>
</script>
</section>

<section data-markdown>
<script type="text/template">
# CSSOM Introduction

- Inline Styles
 - `el.style.property = 'value';`
 - HTML attribute `style='property: value;'`
- Computed style
 - `getComputedStyle(el).property`
- Stylesheets
 - `#foo { color: red;  }`
 - `document.styleSheets`
</script>
</section>

<section data-markdown>
<script type="text/template">
# CSSOM Introduction

Stylesheets vs. inline styles vs. computed styles

<pre><code class="css" data-trim>
#foo { color: red;  }
</code></pre>

<pre><code class="javascript" data-trim>
var el = document.getElementById('foo');
console.log( el.style.color ); // ''
console.log( getComputedStyle(el).color ); // 'red'

el.style.color = 'blue';
console.log( el.style.color ); // blue
console.log( getComputedStyle(el).color ); // 'blue'

el.style.color = '';
console.log( getComputedStyle(el).color ); // 'red'
</code></pre>

</script>
</section>

<section data-markdown>
<script type="text/template">
# CSS vs. JavaScript naming

- CSS uses dashed property names
 - `border-bottom-right-radius`
- JavaScript uses camelCase
 - `borderBottomRightRadius`
- It’s easy to transform them
- `camelize` and `dasherize` from <a href="http://api.prototypejs.org/language/String/prototype/camelize/">Prototype.js</a>, <a href="https://github.com/epeli/underscore.string#string-functions">underscore.string</a>, …
</script>
</section>

<section data-markdown>
<script type="text/template">
# Vendor prefixes #yolo

- Experimental implementations
- `-moz`, `-webkit`, `-ms`, `-o`
<pre><code class="css" data-trim>
-moz-transform: scale(2);
-webkit-transform: scale(2);
-ms-transform: scale(2);
transform: scale(2);
</code></pre>
<pre><code class="javascript" data-trim>
el.style.MozTransform
el.style.WebkitTransform
el.style.msTransform // Yes
el.style.transform
</code></pre>
- <a href="http://caniuse.com/#feat=transforms2d">caniuse.com</a>
</script>
</section>

<section data-markdown>
<script type="text/template">
# Modernizr

- <a href="http://modernizr.com/">Modernizr</a> is a feature detection library
- Allows to detect support for HTML/CSS/JS/SVG…
- var supported = <a href="http://modernizr.com/docs/#testprop">Modernizr.testProp</a>('someProperty');
 - camelCase needed
- var supported = <a href="http://modernizr.com/docs/#testallprops">Modernizr.testAllProps</a>('someProperty')
  - Test ALL the vendor prefixes!
</script>
</section>

<section data-markdown>
<script type="text/template">
# Modernizr’s approach

- I will talk about the internals of the <a href="https://github.com/Modernizr/Modernizr">upcoming version 3.0 (master branch)</a>
- Modernizr tries three detection methods:

- For all possible properties (with vendor prefixes), do:
 1. `CSS.supports(property, value)` else
 2. Use an `@supports` rule else
 3. Check object properties
</script>
</section>

<section data-markdown>
<script type="text/template">
# `CSS.supports(property, value)`

- `var supported = CSS.supports(property, value);`
- Finally, a simple JavaScript API
- The future is here (Firefox and Chrome)
- <a href="http://dev.w3.org/csswg/css-conditional/#the-css-interface">CSS Conditional Rules Module</a>
- <a href="https://github.com/Modernizr/Modernizr/blob/master/src/nativeTestProps.js">Modernizr implementation</a>
</script>
</section>

<section data-markdown>
<script type="text/template">
# @supports CSS rule

1. Create a `style` element, append it to the `head`
2. Add a `@supports` rule with a normal rule that styles an element in the DOM
  ```
  @supports (transform-style: preserve-3d) {
    #test-element { position: absolute; }
  }
  ```
3. Read the computed style of the element<br>
  `var supported = getComputedStyle(el).position === 'absolute';`

<ul>
<li><a href="http://dev.w3.org/csswg/css-conditional/#at-supports">CSS Conditional Rules Module</a>
<li><a href="https://github.com/Modernizr/Modernizr/blob/master/src/nativeTestProps.js">Modernizr implementation</a>
</ul>
</script>
</section>

<section data-markdown>
<script type="text/template">
# Last resort: Check object properties

1. Test if JavaScript property exists (must be a string)<br>
  `'property' in el.style`
2. Set the value to test<br>
  `el.style.property = 'value';`
3. Check if the browser accepted the value. If the browser rejected the value, the value is an empty string.<br>
  `var supported = el.style.property === 'valueToTest';`<br>
</script>
</section>

<section data-markdown>
<script type="text/template">
# Credits &lt;3

- <a href="http://tif.ca">Tiffany Conroy</a>: <a href="https://speakerdeck.com/theophani/what-about-the-cssom">What about the CSSOM?</a>
- <a href="http://tiffanybbrown.com">Tiffany B. Brown</a>: <a href="http://webinista.github.io/Conditional-CSS/">Conditional CSS</a>
- The Modernizr team (Alex Sexton, Patrick Kettner, Stu Cox…)

# Questions? Feedback?

- <a href="https://twitter.com/molily">@molily on Twitter</a>
- <a href="mailto:zapperlott@gmail.com">zapperlott@gmail.com</a>
</script>
</section>

<!-- ******************************************************************** -->

      </div>

    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal-2.1.6.js"></script>

    <script>

      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,
        rollingLinks: false,

        theme: 'simple',
        transition: 'fade',

        // Optional libraries used to extend on reveal.js
        dependencies: [
          { src: 'plugin/markdown/marked.js' },
          { src: 'plugin/markdown/markdown.js' },
          {
            src: 'plugin/highlight/highlight.js',
            async: true,
            callback: function() {
              console.log('hljs.initHighlightingOnLoad');
              hljs.initHighlightingOnLoad();
            }
          }
        ]
      });

    </script>

  </body>
</html>
